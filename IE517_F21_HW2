from sklearn.neighbors import KNeighborsClassifier
from sklearn.model_selection import train_test_split
import matplotlib.pyplot as plt
from sklearn.metrics import accuracy_score 
import numpy as np
import pandas as pd

df = pd.read_csv('/home/akashs5/Downloads/MLF/TS.csv')

# KNN portion
X= df.iloc[:,2:-1]
y= df.iloc[:,-1:]
y=df['squeeze'].astype(int)

X_train, X_test, y_train,y_test = train_test_split(X,y,test_size=0.3, random_state=42)

k_range = range(1,26)
scores =[]
for k in k_range:
    knn=KNeighborsClassifier(n_neighbors=k)
    knn.fit(X_train,y_train)
    y_pred=knn.predict(X_test)
    scores.append(accuracy_score(y_test,y_pred))

plt.plot(k_range,scores)
plt.xlabel('K values')
plt.xlabel('Score ')
plt.title('KNN Method on Treasury DATASET')

# Decision Tree Method
from sklearn.tree import DecisionTreeClassifier
tree = DecisionTreeClassifier(criterion='gini',max_depth=5,random_state=1)
tree.fit(X_train,y_train)
y_predict = tree.predict(X_test)
acc= accuracy_score(y_predict,y_test)
print("Accuracy for Decision Tree classifier with max depth 5 is Tresury Dataset")
print(acc)
print("My name is {Akash Singh}")
print("My NetID is: {akashs5}")
print("I hereby certify that I have read the University policy on Academic Integrity and that I am not in violation.")